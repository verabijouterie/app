<div class="max-w-7xl mx-auto px-4 py-10">
  <div class="bg-white rounded-xl shadow-sm ring-1 ring-gray-900/5 p-8">
    <div class="flex justify-between items-center mb-8">
      <h1 class="text-2xl font-semibold text-gray-900">Toptan Alışverişler</h1>
      <button mat-raised-button color="primary" (click)="createNewSupply()">
        <mat-icon>add</mat-icon>
        Yeni Alışveriş
      </button>
    </div>

    <div class="space-y-6">
      @for (supply of supplies; track supply.id) {
        <div class="bg-white rounded-lg shadow p-6">
          <div class="flex justify-between items-start mb-4">
            <div>
              <h2 class="text-lg font-semibold text-gray-900">
                #{{ supply.id }} - {{ supply.date | date:'dd/MM/yyyy' }}
                <br>
                {{ supply.wholesaler_name }}
              </h2>
            </div>
            <div class="flex gap-2">
              <button mat-icon-button color="accent" [routerLink]="['/supplies', supply.id]" matTooltip="Düzenle">
                <mat-icon>edit</mat-icon>
              </button>
              <button mat-icon-button color="warn" (click)="deleteSupply(supply.id!)" matTooltip="Sil">
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>

          <div class="space-y-2">
            @for (transaction of supply.transactions; track transaction.id) {
              <div class="flex items-center justify-between py-2 border-b border-gray-100"
                   [ngClass]="{'bg-red-50': transaction.direction === 'Out', 'bg-green-50': transaction.direction === 'In'}">
                <div class="flex items-center gap-4">
                  <span class="text-sm font-medium text-gray-900">
                    @if (transaction.type === 'Product' && transaction.carat) {
                      {{ transaction.quantity }} x {{ transaction.product_name }} / {{ transaction.carat }} Ayar / {{ transaction.weight_brut_total }} g
                    }
                    @if (transaction.type === 'Product' && !transaction.carat) {
                      {{ transaction.quantity }} x {{ transaction.product_name }}
                    }
                    @else if (transaction.type === 'Scrap') {
                      Hurda / {{ transaction.carat }} Ayar / {{ transaction.weight_brut_total }} g
                    } @else if (transaction.type === 'Cash') {
                      Nakit
                    } @else if (transaction.type === 'Bank') {
                      Banka
                    }
                  </span>
                </div>
              </div>
            }
          </div>
        </div>
      }
    </div>

    <div class="flex justify-center mt-4" *ngIf="!allLoaded">
      <button 
        mat-raised-button 
        color="primary" 
        (click)="loadMore()" 
        [disabled]="loading">
        <mat-icon *ngIf="loading">sync</mat-icon>
        <span>{{ loading ? 'Yükleniyor...' : 'Daha Fazla Yükle' }}</span>
      </button>
    </div>
  </div>
</div>